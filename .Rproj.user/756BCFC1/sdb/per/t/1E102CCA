{
    "collab_server" : "",
    "contents" : "\n# tidy_source(width.cutoff = 70)\nsetwd(\"~/tra_business_cycle\")\nsink(file = \"business_cycle\",append = FALSE)\n\n# R Programme to estimate trend and cyclic components of \n# macroeconomic variables\n# By Eliab G. Luvanda\n# October 2015\n\n\nrm(list = ls())\n# Loading required packages\nrequire(mFilter)\n\n# Setting working dirctory\n\n# Opening data file\nb_cycle_data <- read.csv(\"b_cycle_data.csv\")\n# View(b_cycle_data)\nattach(b_cycle_data)\n\n# Taking logs of variables\nlgdp <- log(gdp2001)\nlrexp <- log(rexp)\nldexp <- log(dexp)\nltexp <- log((rexp + dexp))\nlm1 <- log(m1)\nlm2 <- log(m2)\nlm3 <- log(m3)\nleduties <- log(eduties)\nlincome <- log(income)\nlothers <- log(others)\nlttaxrevenue <- log(ttaxrevenue)\nlexrate <- log(exrate)\n\nrequire(ggplot2)\nggplot(b_cycle_data,aes(year)) +\n  geom_line(aes(y = lttaxrevenue), colour = \"green\") +\n  geom_line(aes(y = lincome), colour = \"blue\") +\n  geom_line(aes(y = leduties), colour = \"red\") +\n  geom_line(aes(y = lothers), colour = \"black\") +\n  scale_colour_manual(\"Direction\", c(\"tax\" = \"green\",\n           \"income\" = \"blue\",\"duties\" = \"red\", \"others\" = \"black\"))\n \n\n# Time series variables\nlgdp <- ts(lgdp, start = 1966, end = 2010, frequency = 1)\nlrexp <- ts(lrexp, start = 1966, end = 2010, frequency = 1)\nldexp <- ts(ldexp, start = 1966, end = 2010, frequency = 1)\nltexp <- ts(ltexp, start = 1966, end = 2010, frequency = 1)\nlm2 <- ts(lm2, start = 1966, end = 2010, frequency = 1)\nleduties <- ts(leduties, start = 1966, end = 2010, frequency = 1)\nlincome <- ts(lincome, start = 1966, end = 2010, frequency = 1)\nlothers <- ts(lothers, start = 1966, end = 2010, frequency = 1)\nlttaxrevenue <- ts(lttaxrevenue, start = 1966, end = 2010, frequency = 1)\ninflation <- ts(inflation, start = 1966, end = 2010, frequency = 1)\nexrate <- ts(exrate, start = 1966, end = 2010, frequency = 1)\n\n# b_cycle_data <- ts(b_cycle_data, start = 1966, end = 2010, frequency = 1)\n\n# plot.ts(ttaxrevenue,type = \"l\",main = \"Taxes\",ylab = \"\")\n# lines(income,lty = 2,lwd = 2)\n# lines(eduties,lty = 3,lwd = 2)\n# lines(others,lty = 4,lwd = 2)\n\nplot.ts(lttaxrevenue,type = \"l\",main = \"Taxes\",ylab = \"\",ylim = c(0,18))\nlines(lincome,lty = 2,lwd = 2)\nlines(leduties,lty = 3,lwd = 2)\nlines(lothers,lty = 4,lwd = 2)\n\n\n \n\n\n# Plot variables on graph\npar(bty = \"l\",font = 2)\nplot.ts(lgdp,type = \"l\",main = \"GDP\",ylab = \"\")\nplot.ts(lrexp,main = \"Recurrent Expenditure\",ylab = \"\")\nplot.ts(ldexp,main = \"Development Expenditure\",ylab = \"\")\nplot.ts(ltexp,main = \"Government Expenditure\",ylab = \"\")\nplot.ts(lm2,main = \"Money Supply\",ylab = \"\")\nplot.ts(leduties,main = \"Import and Excise Duties\",ylab = \"\")\nplot.ts(lincome,main = \"Income tax\",ylab = \"\")\nplot.ts(lothers,main = \"Other Taxes\",ylab = \"\")\nplot.ts(lttaxrevenue,main = \"Tax Revenue\",ylab = \"\")\nplot.ts(inflation,main = \"Inflation\",ylab = \"\")\nplot.ts(exrate,main = \"Exchange Rate\",ylab = \"TZS/USD\")\n\n# Estimation of trend and cyclic componemts by HP filter\n# GDP\npar(bty = \"l\",font = 1)\npar(mfrow = c(1,2))\n\ngdpf <- hpfilter(lgdp,type = \"lambda\")\nplot(gdpf$trend,ylab = \"\", main = \"GDP\",lwd = 2, col = \"blue\")\nlines(lgdp,lty = 1, lwd = 2, col = \"red\")\nlegend(\"topleft\",legend = c(\"Trend\",\"Actual\"), lty = 1,\n       col = c(\"blue\", \"red\"), bty = \"n\", cex = 0.8, \n       text.col = c(\"blue\", \"red\"))\nplot(gdpf$cycle,ylab = \"Year\",main = \"Cyclic component\", col = \"blue\")\n# plot(lttaxrevenuep$cycle,ylab = \"\",main = \"Tax Revenue\")\n\n\npar(bty = \"l\", font = 1)\npar((mfrow = c(1,2)))\n# Tax revenue\n lttaxrevenuep <- hpfilter(lttaxrevenue,type = \"lambda\")\n# plot(lttaxrevenuep$trend,ylab = \"\",main = \"A: Tax Revenue\",lwd = 2)\n# lines(lttaxrevenue,lty = 2,lwd = 2)\n# legend(\"topleft\",c(\"Trend\",\"Actual\"),lty = 1:2,ncol = 2,bty = \"n\",cex = 0.7)\nplot(lttaxrevenuep$cycle,ylab = \"\",main = \"Tax Revenue\", col = \"blue\")\nplot(gdpf$cycle,ylab = \"\",main = \"GDP\", col = \"red\")\n\n# Income tax\nlincomep <- hpfilter(lincome, type = \"lambda\")\n# plot(lincomep$trend,ylab = \"\", main = \"A: Income Tax\", lwd = 2)\n# lines(lincome, lty = 2, lwd = 2)\n# legend(\"topleft\", c(\"Trend\", \"Actual\"), lty = 1:2, ncol = 2, bty = \"n\", cex = 0.6)\nplot(lincomep$cycle, ylab = \"\", main = \"Income Tax\", col = \"blue\")\nplot(gdpf$cycle,ylab = \"\",main = \"GDP\", col = \"red\")\n\n# Import and excise duties\nledutiesp <- hpfilter(leduties, type = \"lambda\")\n# plot(ledutiesp$trend,ylab = \"\", main = \"A: Import and Excise\", lwd = 2)\n# lines(leduties, lty = 2, lwd = 2)\n# legend(\"topleft\", c(\"Trend\", \"Actual\"), lty = 1:2, ncol = 2, bty = \"n\", cex = 0.6)\nplot(ledutiesp$cycle, ylab = \"\", main = \"Import and Excise\", col = \"blue\")\nplot(gdpf$cycle,ylab = \"\",main = \"GDP\", col = \"red\")\n\n# Other taxes\nlothersp <- hpfilter(lothers, type = \"lambda\")\n# plot(lothersp$trend,ylab = \"\", main = \"A: Other Taxes\", lwd = 2)\n# lines(lothers, lty = 2, lwd = 2)\n# legend(\"topleft\", c(\"Trend\", \"Actual\"), lty = 1:2, ncol = 2, bty = \"n\", cex = 0.6)\nplot(lothersp$cycle, ylab = \"\", main = \"Other Taxes\", col = \"blue\")\nplot(gdpf$cycle,ylab = \"\",main = \"GDP\", col = \"red\")\n\npar(bty = \"l\",font = 1)\npar(mfrow = c(1,2))\n# Inflation\ninflationp <- hpfilter(inflation,type = \"lambda\")\n# plot(inflationp$trend,ylab = \"\", main = \"A: Inflation\",ylim = c(5,42),lwd = 2)\n# lines(inflation,lty = 2,lwd = 2)\n# legend(\"topright\",c(\"Trend\",\"Actual\"),lty = 1:2,ncol = 2,bty = \"n\",cex = 0.6)\nplot(inflationp$cycle, ylab = \"\", main = \"Inflation\", col = \"blue\")\nplot(gdpf$cycle,ylab = \"\",main = \"GDP\", col = \"red\")\n\n# Government Expenditure\nltexpp <- hpfilter(ltexp,type = \"lambda\")\n# plot(ltexpp$trend,ylab = \"\", main = \"A: Government Expenditure\",lwd = 2)\n# lines(ltexp,lty = 2,lwd = 2)\n# legend(\"topleft\",c(\"Trend\",\"Actual\"),lty = 1:2,ncol = 2,bty = \"n\",cex = 0.6)\nplot(ltexpp$cycle,ylab = \"\",main = \"Government Expenditure\", col = \"blue\")\nplot(gdpf$cycle,ylab = \"\",main = \"GDP\", col = \"red\")\n\n# Money supply: m2\nlm2p <- hpfilter(lm2,type = \"lambda\")\n# plot(lm2p$trend,ylab = \"\", main = \"Money Supply -M2\",lwd = 2)\n# lines(lm2,lty = 2,lwd = 2)\n# legend(\"topleft\",c(\"Trend\",\"Actual\"),lty = 1:2,ncol = 2,bty = \"n\",cex = 0.6)\nplot(lm2p$cycle,ylab = \"\",main = \"Money Supply -M2\", col = \"blue\")\nplot(gdpf$cycle,ylab = \"\",main = \"GDP\", col = \"red\")\n\n# Unit root test: Zivot Andrews unit Root test\nrequire(urca)\nza.gdp <- ur.za(lgdp,model = \"both\", lag = 2)\nsummary(za.gdp)\nza.ttaxrevenue <- ur.za(lttaxrevenue, model = \"both\",lag = 2)\nsummary(za.ttaxrevenue)\nza.duties <- ur.za(leduties, model = \"both\", lag = 2)\nsummary(za.duties)\nza.income <- ur.za(lincome, model = \"both\", lag = 2)\nsummary(za.income)\nza.others <- ur.za(lothers, model = \"both\", lag = 2)\nsummary(za.others)\n\n# Computation volatility measure of cyclic components\nsd(gdpf$cycle)\nsd(lttaxrevenuep$cycle)\nsd(lincomep$cycle)\nsd(ledutiesp$cycle)\nsd(lothersp$cycle)\nsd(inflationp$cycle)\nsd(ltexpp$cycle)\nsd(lm2p$cycle)\n\n# Computation of correlation coefficient between cyclic components\ncor.test(gdpf$cycle, lttaxrevenuep$cycle, method = \"kendall\",alternative = \"g\")\ncor.test(gdpf$cycle, lincomep$cycle, method = \"kendall\")\ncor.test(gdpf$cycle, ledutiesp$cycle, method = \"kendall\")\ncor.test(gdpf$cycle, lothersp$cycle, method = \"kendall\")\ncor.test(gdpf$cycle, inflationp$cycle, method = \"kendall\")\ncor.test(gdpf$cycle, ltexpp$cycle, method = \"kendall\")\ncor.test(gdpf$cycle, lm2p$cycle, method = \"kendall\")\n\n\n\nrequire(MTS)\ntax <- cbind(gdpf$cycle,lttaxrevenuep$cycle)\nmq(tax,lag = 10)\ninc <- cbind(gdpf$cycle, lincomep$cycle)\nmq(inc,lag = 10)\n\nduty <- cbind(gdpf$cycle, ledutiesp$cycle)\nmq(duty,lag = 10)\n\nothe <- cbind(gdpf$cycle,lothersp$cycle)\nmq(othe,lag = 5)\n",
    "created" : 1456985291295.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4094213264",
    "id" : "1E102CCA",
    "lastKnownWriteTime" : 1457841664,
    "last_content_update" : 1457841664127,
    "path" : "~/tra_business_cycle/b_cycles.R",
    "project_path" : "b_cycles.R",
    "properties" : {
        "source_window_id" : ""
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}